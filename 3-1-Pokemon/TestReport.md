# 宠物小精灵多人对战游戏 测试报告

> 2014211306 李俊宁 2014211288
>
> 2016年 12月 22日

## 1. 范围

### 1.1. 项目概述

#### a. 被测软件名称

- 宠物小精灵多人对战游戏

#### b. 版本

- v0.1

#### c. 被测软件用途

- 适合作为简单的多人互动游戏，从而能为更多的玩家服务；
- 作为 程序设计实践 学习和实践的项目；

#### d. 被测软件的组成及功能

依赖库：

- *[ORM Lite](https://github.com/BOT-Man-JL/ORM-Lite)*
- *[EggAche GL](https://github.com/BOT-Man-JL/EggAche-GL)*
- *[json](https://github.com/nlohmann/json)*

程序模块：

- Socket 模块，负责基本的 Socket 通信；
- Pokemon 模块，负责与宠物小精灵相关的属性、战斗逻辑；
- Server 模块，负责服务器业务逻辑的实现；
- Client 模块，负责客户端协议的实现；
- GUI Client 模块，负责客户端业务逻辑的实现，即最终用户使用的部分；

测试模块：

- Pokemon Test 模块，负责 Pokemon 模块的单元测试；
- Client Test 模块，负责除 GUI 相关以外业务逻辑的单元测试；
- GUI Client 模块，负责综合测试；

### 1.2. 测试概述

#### Test 1: Pokemon Test

- 被测对象：Pokemon 模块
  - 小精灵对战
  - 小精灵升级
- 测试环境：自动化测试
  - Windows - MSVC 2015 (TestPokemon)
  - Ubuntu - gcc 5.4 / clang 3.8 (TestPokemon)

#### Test 2: Client Test

- 被测对象：Socket 模块，Server 模块（部分），Client 模块
  - 用户管理
  - 查看用户/小精灵
  - 房间系统
- 测试环境：自动化测试
  - Windows - MSVC 2015 (Server / TestClient)
  - Ubuntu - gcc 5.4 / clang 3.8 (Server / TestClient)

#### Test 3: Integrate Test

- 被测对象：所有模块
  - 图形界面 注册、登录用户
  - 图形界面 开始界面/查询界面
  - 图形界面 房间系统
  - 图形界面 游戏 / 游戏结果
- 测试环境：真实环境
  - Windows - MSVC 2015 (Server / GUIClient)
  - Ubuntu - gcc 5.4 / clang 3.8 (Server)

## 2. 结果

### 2.1. Test 1: Pokemon Test

#### 2.1.1. Test 1.1: 小精灵对战

- 综述：小精灵进行回合制对战；
- 初始化：生成 2 个 `Pikachu` 和一个 `Charmander`；
- 步骤：
  1. `Pikachu1` 先手对 `Charmander`，轮流调用 `Attack` 函数到一方胜利；
  2. `Charmander` 先手对 `Pikachu1`，轮流调用 `Attack` 函数到一方胜利；
  3. `Charmander` 先手对 `Pikachu2`，轮流调用 `Attack` 函数到一方胜利；
  4. `Pikachu2` 先手对 `Charmander`，轮流调用 `Attack` 函数到一方胜利；
  5. `Pikachu1` 先手对 `Pikachu2`，轮流调用 `Attack` 函数到一方胜利；
  6. `Pikachu2` 先手对 `Pikachu1`，轮流调用 `Attack` 函数到一方胜利；
  7. 每轮对战结束后，恢复小精灵生命值；
- 预期结果与评估标准：
  - 由于 `Attack` 函数使用 Device Random 产生随机数，
    所以结果不能用 `assert` 自动判断；
  - 根据每次 `Attack` 的结果判断 `_GetDamagePoint` 正确性；
  - 根据每次 `GetHP` `GetLevel` `GetExp` 的结果判断中间过程是否正确；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

#### 2.1.1. Test 1.1: 小精灵升级

- 综述：小精灵通过回合制对战，获取经验并升级；
- 初始化：生成 2 个 `Pikachu` 和一个 `Charmander`；
- 步骤：
  1. `Pikachu1` 先手对 `Charmander`，轮流调用 `Attack` 函数到一方胜利；
  2. `Charmander` 先手对 `Pikachu1`，轮流调用 `Attack` 函数到一方胜利；
  3. `Charmander` 先手对 `Pikachu2`，轮流调用 `Attack` 函数到一方胜利；
  4. `Pikachu2` 先手对 `Charmander`，轮流调用 `Attack` 函数到一方胜利；
  5. `Pikachu1` 先手对 `Pikachu2`，轮流调用 `Attack` 函数到一方胜利；
  6. `Pikachu2` 先手对 `Pikachu1`，轮流调用 `Attack` 函数到一方胜利；
  7. 每轮对战结束后，恢复小精灵生命值；
- 预期结果与评估标准：
  - 由于 `Attack` 函数使用 Device Random 产生随机数，
    所以结果不能用 `assert` 自动判断；
  - 根据每次 `Attack` 的结果判断 获取经验 / 升级 正确性；
  - 根据每次 `GetHP` `GetLevel` `GetExp` 的结果判断中间过程是否正确；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

### 2.2. Test 2: Client Test

#### 2.2.1. Test 2.1: 用户管理

- 综述：注册、登录、注销相关功能的测试；
- 初始化：
  - 冷启动服务器，使用无数据的数据库（由服务器初始化）；
  - 同时启动 3 个 `Client`，连接到该服务器；
- 步骤：
  1. `Client1` 使用 "Johnny", "John" 作为用户名、密码注册；
  2. `Client1` 使用 "Johnny", "Johnny" 作为用户名、密码注册；
  3. `Client1` 使用 "Johnny", "Johnny" 作为用户名、密码注册；
  4. `Client1` 使用 "Johnny", "Johnny" 作为用户名、密码登录；
  5. `Client1` 使用 "Johnny", "Johnny" 作为用户名、密码登录；
  6. `Client1` 使用 "Johnny", "Hack" 作为用户名、密码登录；
  7. `Client1` 登出；
  8. `Client1` 登出；
  9. `Client2` 使用 "John", "LeeLee" 作为用户名、密码注册；
  10. `Client2` 使用 "John", "LeeLee" 作为用户名、密码登录；
  11. `Client3` 使用 "BOT", "ManMan" 作为用户名、密码注册；
  12. `Client3` 使用 "BOT", "ManMan" 作为用户名、密码登录；
- 预期结果与评估标准：
  1. 注册失败，服务器返回 "Empty UID or Pwd's Size < 6"；
  2. 注册成功，服务器返回 "Registered successfully"；
  3. 注册失败，服务器返回 "UserID has been Taken"；
  4. 登录成功，服务器返回 `Johnny` 的用户模型；
  5. 登录成功，服务器返回 `Johnny` 的用户模型，之前登录失效；
  6. 登录失败，服务器返回 "Bad Login Attempt"；
  7. 登出成功，服务器返回 "Logout Successfully"；
  8. 登出失败，服务器返回 "You haven't Login"；
  9. 注册成功，服务器返回 "Registered successfully"；
  10. 登录成功，服务器返回 `John` 的用户模型；
  11. 注册成功，服务器返回 "Registered successfully"；
  12. 登录成功，服务器返回 `BOT` 的用户模型；
  13. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

#### 2.2.2. Test 2.2: 查看用户/小精灵

- 综述：查看用户/小精灵 相关功能的测试；
- 初始化：
  - 热启动服务器；
  - 使用完成 Test 2.1 后得到的数据库 和 3 个 `Client`；
- 步骤：
  1. `Client1` 查询小精灵；
  2. `Client1` 查询所有用户；
  3. `Client1` 查询当前用户；
  4. `Client2` 查询小精灵；
  5. `Client3` 查询所有用户；
  6. `Client2` 查询当前用户；
- 预期结果与评估标准：
  1. 查询失败，服务器返回 "You haven't Login"；
  2. 查询失败，服务器返回 "You haven't Login"；
  3. 查询失败，服务器返回 "You haven't Login"；
  4. 查询成功，服务器返回 9个 小精灵模型；
  5. 查询成功，服务器返回 3个 用户模型，"Johnny" 离线，"John" "BOT" 在线；
  6. 查询成功，服务器返回 "John" 的用户模型；
  7. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

#### 2.2.3. Test 2.3: 房间系统

- 综述：房间系统 相关功能的测试；
- 初始化：
  - 热启动服务器；
  - 使用完成 Test 2.2 后得到的数据库 和 3 个 `Client`；
- 步骤：
  1. `Client2` 使用小精灵 `1`，进入 "Hello" 房间；
  2. `Client2` 使用小精灵 `5`，进入 "Hello" 房间；
  3. `Client2` 离开房间；
  4. `Client2` 使用小精灵 `5`，进入 "Hello" 房间；
  5. `Client2` 使用小精灵 `5`，进入 "Hello2" 房间；
  6. `Client3` 使用小精灵 `8`，进入 "Hello2" 房间；
  7. `Client3` 查询所有房间；
  8. `Client3` 离开房间；
  9. `Client3` 离开房间；
  10. `Client3` 使用小精灵 `8`，进入 "Hello" 房间；
  11. `Client3` 查询所有房间；
  12. `Client3` 准备完成，并查询房间内玩家状态；
  13. `Client2` 准备完成，并查询房间内玩家状态；
  14. `Client2` 离开房间；
  15. `Client2` 使用小精灵 `5`，进入 "Hello" 房间；
  16. `Client2` 准备未完成，并查询房间内玩家状态；
  17. `Client2` 查询所有房间；
  18. `Client3` 离开房间；
- 预期结果与评估标准：
  1. 进入失败，服务器返回 "It's NOT your Pokemon"；
  2. 进入成功，服务器返回 地图尺寸 300 * 200；
  3. 离开成功，服务器返回 "Left the Room"；
  4. 进入成功，服务器返回 地图尺寸 300 * 200；
  5. 进入失败，服务器返回 "Already in a Room"；
  6. 进入成功，服务器返回 地图尺寸 300 * 200；
  7. 查询成功，服务器返回 2 个房间，"Hello", "Hello2"，均未开始游戏；
  8. 离开成功，服务器返回 "Left the Room"；
  9. 离开失败，服务器返回 "Not in a Room"；
  10. 进入成功，服务器返回 地图尺寸 300 * 200；
  11. 查询成功，服务器返回 1 个房间，"Hello" 未开始游戏；
  12. 准备成功，服务器返回 2 个玩家，"John" 未准备，"BOT" 准备完成；
  13. 准备成功，服务器返回 2 个玩家，"John", "BOT" 均准备完成；
  14. 离开成功，服务器返回 "Left the Room"；
  15. 进入失败，服务器返回 "Room is in Game"；
  16. 查询失败，服务器返回 "Not in a Room"；
  17. 查询成功，服务器返回 1 个房间，"Hello" 已开始游戏；
  18. 离开成功，服务器返回 "Left the Room"；
  19. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

### 2.3. Test 3: Integrate Test

#### 2.3.1. Test 3.1: 图形界面 注册、登录用户

- 综述：图形界面 注册、登录用户 相关功能的测试；
- 初始化：
  - 冷启动服务器，使用无数据的数据库（由服务器初始化）；
  - 同时启动 2 个 `Client`，连接到该服务器；
  - 起始界面为 登录界面；
- 步骤：
  1. `Client1` 使用 "Jack", "LeeLee" 作为用户名、密码登录；
  2. `Client1` 使用 "Jack", "Lee" 作为用户名、密码注册；
  3. `Client1` 使用 "Jack", "LeeLee" 作为用户名、密码注册；
  4. `Client1` 使用 "Jack", "LeeLee" 作为用户名、密码注册；
  5. `Client1` 使用 "Jack", "LeeLee" 作为用户名、密码登录；
  6. `Client2` 使用 "Jack", "LeeLee" 作为用户名、密码登录；
  7. `Client2` 关闭窗口；
- 预期结果与评估标准：
  1. 登录失败，服务器返回 "Bad Login Attempt"；
  2. 注册失败，服务器返回 "Empty UID or Pwd's Size < 6"；
  3. 注册成功，服务器返回 "Registered successfully"；
  4. 注册失败，服务器返回 "UserID has been Taken"；
  5. 登录成功，进入开始界面；
  6. `Client1` 掉线，回到登录界面；`Client2` 登录成功，进入开始界面；
  7. 登出成功，回到登录界面；
  8. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

#### 2.3.2. Test 3.2: 图形界面 开始界面/查询界面

- 综述：图形界面 开始界面/查询界面 相关功能的测试；
- 初始化：
  - 热启动服务器；
  - 同时启动 2 个 `Client`，连接到该服务器；
  - 注册并登录 2 个用户 "John", "Jack"，起始界面为 开始界面；
- 步骤：
  1. `Client1` 点击 View Pokemons 按钮；
  2. `Client1` 关闭窗口；
  3. `Client1` 点击 View Users 按钮；
  4. `Client2` 关闭窗口；
  5. `Client2` 重新登录；
  6. `Client1` 关闭窗口；
  7. `Client1` 输入底下列表中的 PID，点击 Play；
  8. `Client1` 关闭窗口；
  9. `Client1` 选择第一只小精灵；
  10. `Client1` 关闭窗口；
  11. `Client1` 输入不在底下列表中的 PID，点击 Play；
- 预期结果与评估标准：
  1. 进入 查看小精灵 界面，显示 6 只小精灵，分别属于 "John", "Jack"；
  2. 返回开始界面；
  3. 进入 查看所有用户 界面，显示 2 个在线用户，"John", "Jack"；
  4. `Client1` 界面中，"Jack" 变为离线；
  5. `Client1` 界面中，"Jack" 变为在线；
  6. 返回开始界面；
  7. 进入 房间界面，显示没有任何房间；
  8. 返回开始界面；
  9. 进入 房间界面，显示没有任何房间；
  10. 返回开始界面；
  11. 进入房间失败，提示不是你的小精灵；
  12. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

#### 2.3.3. Test 3.3: 图形界面 房间系统

- 综述：图形界面 房间系统 相关功能的测试；
- 初始化：
  - 热启动服务器；
  - 同时启动 4 个 `Client`，连接到该服务器；
  - 注册并登录 4 个用户；
  - 选择每个玩家的第一个小精灵，起始界面为 房间界面；
- 步骤：
  1. `Client1` 进入房间 "haha"；
  2. `Client1` 准备完成；
  3. `Client2` 进入房间 "lala"；
  4. `Client2` 离开房间；
  5. `Client2` 进入房间 "haha"；
  6. `Client3` 进入房间 "haha"；
  7. `Client4` 进入房间 "haha"；
  8. `Client2` 准备完成；
  9. `Client3` 关闭窗口，在进入 房间界面；
  10. `Client3` 进入房间 "haha"；
  11. `Client3` 进入房间 "lala"；
  12. `Client4` 进入房间 "lala"；
  13. `Client3` 准备完成；
  14. `Client3` 准备未完成；
  15. `Client3` 准备完成；
  16. `Client4` 准备完成；
  17. 进入房间均使用 键盘输入方式、鼠标点击方式 测试；
- 预期结果与评估标准：
  1. 进入成功，显示玩家 未准备完成，房间列表有 "haha"；
  2. 准备成功，显示玩家 准备完成；
  3. 进入成功，显示玩家 未准备完成，房间列表有 "haha", "lala"；
  4. 离开成功，房间列表有 "haha"；
  5. 进入成功，显示玩家 1 准备完成，玩家 2 未准备完成；
  6. 进入成功，显示玩家 1 准备完成，玩家 2, 3 未准备完成；
  7. 进入失败，服务器返回 "Room is Full"；
  8. 准备成功，显示玩家 1, 2 准备完成，玩家 3 未准备完成；
  9. 离开房间成功，玩家 1, 2 进入游戏，房间列表有 "haha"，正在游戏；
  10. 进入失败，服务器返回 "Room is in Game"；
  11. 进入成功，显示玩家 未准备完成，房间列表有 "haha", "lala"；
  12. 进入成功，显示玩家均 未准备完成；
  13. 准备成功，显示玩家 3 准备完成，玩家 4 未准备完成；
  14. 未准备成功，显示玩家均 未准备完成；
  15. 准备成功，显示玩家 3 准备完成，玩家 4 未准备完成；
  16. 进入游戏；
  17. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁

#### 2.3.4. Test 3.4: 图形界面 游戏 / 游戏结果

- 综述：图形界面 房间系统 相关功能的测试；
- 初始化：
  - 热启动服务器；
  - 使用完成 Test 3.3 后得到的数据库 和 4 个 `Client`；
- 步骤：
  1. `Client1` 连续上下左右移动；
  2. `Client1` 连续左击鼠标；
  3. `Client2` 连续上下左右移动；
  4. `Client2` 连续左击鼠标；
  5. `Client3` 连续上下左右移动；
  6. `Client3` 连续左击鼠标；
  7. `Client1` 连续一个方向移动；
  8. `Client1` 向 `Client2` 方向连续点击，直到游戏结束；
  9. `Client3` 关闭窗口；
  10. `Client1` 关闭窗口；
- 预期结果与评估标准：
  1. `Client1` `Client2` 均看到玩家 1 同步移动；
  2. `Client1` `Client2` 均看到玩家 1 沿点击方向发动攻击；
  3. `Client1` `Client2` 均看到玩家 2 同步移动；
  4. `Client1` `Client2` 均看到玩家 2 沿点击方向发动攻击；
  5. `Client3` `Client4` 均看到玩家 3 同步移动；
  6. `Client3` `Client4` 均看到玩家 3 沿点击方向发动攻击；
  7. `Client1` `Client2` 均看到玩家 1 移动到地图边界后停止移动；
  8. 玩家 1 向 玩家 2 发动攻击，直到玩家 2 生命值为 0 游戏结束，
     `Client1` `Client2` 显示游戏结果窗口，玩家 1 胜利，玩家 2 失败；
  9. `Client3` `Client4` 显示游戏结果窗口，玩家 3 胜利，玩家 4 失败；
  10. 回到 开始界面；
  11. 实测结果应与预期一致；
- 实测结果：与预期结果一致；
- 用例终止条件：本测试用例的全部测试步骤被执行
  或因某种原因导致测试步骤无法执行（异常终止）；
- 设计人员：李俊宁
- 执行状态：完成
- 执行结果：通过
- 执行人员：李俊宁
